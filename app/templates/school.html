<div id="schools" class="main-content">
	<div class="school-hero" style="background-image:url({{school.banner}});">
		<div class="config" ng-hide="uploadField">
			<a href="" ng-click="enterPictureUpload()"><i class="fa fa-cloud-upload"></i></a>
		</div>
		<div class="upload-field" ng-show="uploadField">
			<form class="pure-form pure-form-stacked" ng-submit="changeDescription()">		
				<input type="file" id="bannerupload" class="options-input" accept="image/png,image/jpeg,image/gif"><br/>
				<input type="submit" value="Speichern" class="btn btn-sm btn-success"/>
			</form>
		</div>
		<h1>{{school.name}}</h1>
		<span class="short-info">Mitglieder: {{school.usercount}}</span>
	</div>
	<div id="tabs">
		<ul>
			<li><a href="#general">Pinnwand</a></li>
			<li><a href="#intragroup">Eure Rangliste</a></li>
			<li><a href="#intergroup" ng-show="interGroupResults.length > 1">Gruppenrangliste</a></li>
		</ul>
		<div class="pure-g-r">
			<div class="pure-u-2-3 conti">
				<div id="general" class="inner">
					<div id="pinboard">
						<form class="pure-form pure-form-stacked main-comment" ng-submit="sendComment()" ng-show="selfIsSchoolMember || selfIsSchoolAdmin || isAdmin" class="pure-form comment-form">
							<textarea ui-keypress="{13:'sendComment()'}" ng-model="comment" class="options-input comment-textarea pure-input-1" placeholder="Poste etwas in diesen Gruppenfeed!"></textarea>
							<input type="submit" class="click-button comment-button btn btn-default pull-right" value="Kommentieren">
						</form>

						<div ng-repeat="comment in school.comments | orderBy:'-time'" class="feed-item feed">
							<div class="feed-entry-symbol" style="background-image:url({{comment.profilepic}})" ng-class="{'no-image': !comment.profilepic }"><i ng-hide="comment.profilepic" class="fa fa-bullhorn"></i></div>
			                <div class="feed-entry-content">
			                	<div class="feed-head">
			                		<span class="feed-time pull-right" title="{{comment.time * 1000 | date:'d.M.yy HH:mm'}}">{{vtime(comment.time)}}</span>
			                		<a href="#/user/{{comment.username}}" class="text-link username">{{comment.username}}</a>
			                		<span ng-show="isAdmin" class="actions">
										<a ng-click="editComment(comment)" style="cursor: pointer">Bearbeiten</a>
										<a ng-click="deleteComment(comment)" style="cursor: pointer">Löschen</a>
									</span>
									<span ng-show="selfIsSchoolAdmin">
										<a ng-click="deleteCommentSA(comment)" style="cursor: pointer">Löschen</a>
									</span>
			                	</div>
			                    <span ng-show="comment.trustedhtml" ng-bind-html="comment.comment">{{comment.comment}}</span>
								<span ng-hide="comment.trustedhtml">{{comment.comment}}</span>
					
			                </div>
						</div>
					</div>
				</div>
				<div id="intragroup" class="inner">
					<div class="table-wrapper">
						<table class="ranking table table-bordered">
							<colgroup>
								<col class="rankcol-1" style="width: 10%">
								<col class="rankcol-2" style="width: 57%">
								<col class="rankcol-3" style="width: 18%">
								<col class="rankcol-4" style="width: 15%">
							</colgroup>
							<tr>
								<th>Rang</th>
								<th>Name</th>
								<th>erh. Provision</th>
								<th>Gesamtvermögen</th>
							</tr>
							<tr ng-repeat="result in intraGroupResults | orderBy:'igrank' ">
								<td>{{result.igrank}}</td>
								<td class="rank-name">
									<a ng-href="#/user/{{result.name}}" style="cursor: pointer">{{result.name}}</a>
									<span ng-show="isAdmin" class="pull-right">
										<a ng-click="kickUser(result)"><i class="fa fa-minus-circle"></i></a>
										<a ng-click="promoteUserToAdmin(result)">Befördern</a>
									</span>
								</td>
								<td>{{result.prov_sum / 10000 | currency}}</td>
								<td>{{result.totalvalue / 10000 | currency}}</td>
							</tr>
						</table>
					</div>
				</div>
				<div id="intergroup" class="inner">
					<div class="table-wrapper">
						<table class="ranking table table-bordered">
							<colgroup>
								<col class="rankcol-1" style="width: 10%">
								<col class="rankcol-2" style="width: 57%">
								<col class="rankcol-3" style="width: 18%">
								<col class="rankcol-3" style="width: 18%">
								<col class="rankcol-4" style="width: 15%">
							</colgroup>
							<tr>
								<th>Rang</th>
								<th>Name</th>
								<th>Spieler</th>
								<th>erh. Provision</th>
								<th>Gesamtvermögen</th>
							</tr>
							<tr ng-repeat="result in interGroupResults | orderBy:'rank' | filter: searchText ">
								<td>{{result.rank}}</td>
								<td><a href="#/s{{result.schoolpath}}">{{result.schoolname}}</a></td>
								<td>{{result.count}}</td>
								<td>{{result.prov_sum / 10000 | currency}}</td>
								<td>{{result.totalvalue / 10000 | currency}}</td>
							</tr>
						</table>
					</div>
				</div>
			</div>
			<div class="pure-u-1-3 widgets">
				<div class="widget">
					<button ng-hide="selfIsSchoolMember" ng-click="enterTeam()" type="button" href="" class="btn btn-primary btn-block">Team beitreten</button>

					<button ng-show="selfIsSchoolMember" ng-click="leaveTeam()" type="button" href="" class="btn btn-danger btn-block"><i class="fa fa-sign-out"></i></button>

				</div>
				<div class="widget" ng-show="school.parentPath">
					<a href="#/s{{school.parentPath}}">zur Übergruppe</a>
				</div>
				<div class="widget schoolInfo">
					<h3>Info</h3>
					<div class="inner">
						<div class="school-descpage">{{descpage}}</div>
						<a ng-show="isAdmin || selfIsSchoolAdmin" ng-click="enterDescpageEdit()"><i class="fa fa-pencil-square-o"></i></a>
						<form ng-submit="changeDescription()" ng-show="editingDescpage" class="pure-form pure-form-stacked">
							<textarea  ng-model="descpage" id="descpage" class="options-input pure-input-1"></textarea>
							<input type="submit" value="Speichern" class="btn btn-primary"/>
						</form>
					</div>				
				</div>
				<div class="widget">
					<h3>Beliebte Aktien</h3>
					<div class="inner">
						<ol class="popularstocks">
							<li ng-repeat="stock in school.popularStocks"><a href="#/trade/buy/{{stock.stockid}}/0">{{stock.stockname}}</a></li>
						</ol>
					</div>
				</div>
				<div class="widget" ng-show="school.admins.length > 0">
					<h3>Administratoren</h3>
					<div class="inner">
						<ul class="groupadminlist">
							<li ng-repeat="admin in school.admins"><a href="#/user/{{admin.adminname}}">{{admin.adminname}}</a></li>
						</ul>
					</div>
				</div>
 				<div class="widget" ng-show="school.subgroups.length > 0 || isAdmin || selfIsSchoolAdmin">
					<h3>Untergruppen</h3>
					<div class="inner">
						<ul class="subschoollist">
							<li ng-repeat="subschool in school.subschools"><a href="#/s/general{{subschool.path}}">{{subschool.name}}</a></li>
						</ul>
						<a ng-show="isAdmin || selfIsSchoolAdmin" ng-click="createSchool()">Neue Untergruppe anlegen</a>
					</div>
				</div>
				<div class="widget" ng-show="isAdmin || selfIsSchoolAdmin">
					<h3>Nicht bestätigte User</h3>
					<div class="inner">
						<ul class="pendinguserslist">
							<li ng-repeat="user in pendingMembers"><a href="#/user/{{user.name}}">{{user.name}}</a> (<a ng-click="verifyMember(user)">bestätigen</a>)</li>
						</ul>
					</div>
				</div>
			</div>
		</div>	
	</div>
</div>
